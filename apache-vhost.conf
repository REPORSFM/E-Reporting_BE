# ============================================================
# Apache Virtual Host Configuration
# Query Report API - CodeIgniter 4
# ============================================================

# Cara Setup di XAMPP/Apache:
# 1. Copy konfigurasi ini ke: C:\xampp\apache\conf\extra\httpd-vhosts.conf
# 2. Edit file C:\Windows\System32\drivers\etc\hosts (as Administrator)
#    Tambahkan: 127.0.0.1 queryreport.local
# 3. Restart Apache
# 4. Akses: http://queryreport.local atau http://192.168.30.70:8080

# ============================================================
# Virtual Host untuk Development
# ============================================================

# Opsi 1: Menggunakan domain queryreport.local (Port 80)
<VirtualHost *:80>
    ServerName queryreport.local
    ServerAlias www.queryreport.local
    DocumentRoot "C:/PROJEK/API/queryreport-api/public"
    
    <Directory "C:/PROJEK/API/queryreport-api/public">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        # Enable rewrite
        RewriteEngine On
        
        # Redirect to index.php if not a file or directory
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ index.php/$1 [L]
    </Directory>
    
    # Logging
    ErrorLog "C:/PROJEK/API/queryreport-api/writable/logs/apache-error.log"
    CustomLog "C:/PROJEK/API/queryreport-api/writable/logs/apache-access.log" combined
</VirtualHost>

# ============================================================
# Opsi 2: Menggunakan IP Address (Port 8080)
# Untuk akses dari komputer lain di jaringan
# ============================================================

<VirtualHost *:8080>
    DocumentRoot "C:/PROJEK/API/queryreport-api/public"
    
    <Directory "C:/PROJEK/API/queryreport-api/public">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        # Enable rewrite
        RewriteEngine On
        
        # Redirect to index.php if not a file or directory
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ index.php/$1 [L]
    </Directory>
    
    # CORS Headers untuk API
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
    
    # Logging
    ErrorLog "C:/PROJEK/API/queryreport-api/writable/logs/apache-error.log"
    CustomLog "C:/PROJEK/API/queryreport-api/writable/logs/apache-access.log" combined
</VirtualHost>

# ============================================================
# NOTES:
# ============================================================
# 1. Pastikan Apache listen di port 8080
#    Edit C:\xampp\apache\conf\httpd.conf
#    Cari: Listen 80
#    Tambahkan: Listen 8080
#
# 2. Pastikan mod_rewrite enabled
#    LoadModule rewrite_module modules/mod_rewrite.so
#
# 3. Pastikan mod_headers enabled
#    LoadModule headers_module modules/mod_headers.so
#
# 4. Restart Apache setelah konfigurasi
#
# 5. Test akses:
#    - Lokal: http://localhost:8080/api/login
#    - Network: http://192.168.30.70:8080/api/login
# ============================================================
